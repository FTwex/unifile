<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Test Unifile</title>
  </head>
  <body>
    <button id="authButton" type="button">Authorize GitHub</button>
    <input type="text" name="path" value="/" id="path">
    <button id="lsButton" type="button">List all repos</button>
    <h3>Result</h3>
    <p id='result'></p>
    <script type="text/javascript" charset="utf-8">
      var res = document.getElementById('result');
      var btn = document.getElementById('authButton');
      btn.onclick = function(){
        var req = new XMLHttpRequest();
        req.open('POST', '/GitHub/authorize', false);
        req.send();
        console.log('res', req.responseText);
        window.open(req.responseText);
      }
      var lsbtn = document.getElementById('lsButton');
      lsbtn.onclick = function(){
        var path = document.getElementById('path').value;
        var req = new XMLHttpRequest();
        req.open('GET', '/GitHub/ls/' + path, false);
        req.send();
        var result = JSON.parse(req.response);
        res.textContent = Array.isArray(result) ? result.map((repo) => repo.name).join('\n') : JSON.toString(result);
      }
    </script>
  </body>
</html>
